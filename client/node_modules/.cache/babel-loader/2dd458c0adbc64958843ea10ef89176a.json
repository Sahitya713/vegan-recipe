{"ast":null,"code":"import _defineProperty from\"C:/NTU/Admin/internship/recipe app - abillionveg/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"C:/NTU/Admin/internship/recipe app - abillionveg/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"C:/NTU/Admin/internship/recipe app - abillionveg/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/NTU/Admin/internship/recipe app - abillionveg/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/NTU/Admin/internship/recipe app - abillionveg/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/NTU/Admin/internship/recipe app - abillionveg/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Recipe=/*#__PURE__*/function(_Component){_inherits(Recipe,_Component);var _super=_createSuper(Recipe);function Recipe(){var _this;_classCallCheck(this,Recipe);_this=_super.call(this);_this.selectImages=function(event){var image=event.target.files[0];_this.setState({image:image});};_this.handleStepAdd=function(event){event.preventDefault();var values=_toConsumableArray(_this.state.steps);values.push({instruction:\"Enter instruction\"});_this.setState({steps:values});};_this.handleStepDelete=function(event){event.preventDefault();var id=event.target.id;var values=_toConsumableArray(_this.state.steps);values.splice(id,1);_this.setState({steps:values});};_this.handleStep=function(event){var _event$target=event.target,id=_event$target.id,name=_event$target.name,value=_event$target.value;var values=_toConsumableArray(_this.state.steps);values[id][name]=value;_this.setState({steps:values});};_this.handleIngredientAdd=function(event){event.preventDefault();var values=_toConsumableArray(_this.state.ingredients);values.push({name:\"Enter ingredient name\",quantity:\"Enter quantity\"});_this.setState({ingredients:values});};_this.handleIngredientDelete=function(event){event.preventDefault();var id=event.target.id;var values=_toConsumableArray(_this.state.ingredients);values.splice(id,1);_this.setState({ingredients:values});};_this.handleIngredient=function(event){var _event$target2=event.target,id=_event$target2.id,name=_event$target2.name,value=_event$target2.value;var values=_toConsumableArray(_this.state.ingredients);values[id][name]=value;_this.setState({ingredients:values});};_this.handleChange=function(event){var _event$target3=event.target,name=_event$target3.name,value=_event$target3.value;_this.setState(_defineProperty({},name,value));};_this.handleSubmit=function(event){event.preventDefault();_this.createRecipe();};_this.createRecipe=function(){var err=[];var _this$state=_this.state,steps=_this$state.steps,image=_this$state.image,title=_this$state.title,ingredients=_this$state.ingredients;if(image===null||title===\"Enter title\"||title===\"\"){err.push(\"Please enter all the information\");}else if(!(image.type===\"image/jpeg\"||image.type===\"image/jpg\"||image.type===\"image/png\"||image.type===\"image/pdf\")){err.push(\"Only images of type jpeg, jpg, png or pdf can be uploaded\");}for(var j=0;j<steps.length;j++){if(steps[j].instruction===\"Enter instruction\"||steps[j].instruction===\"\"){err.push(\"Please ensure all the instructions are listed properly\");break;}}for(var i=0;i<ingredients.length;i++){if(ingredients[i].name===\"Enter ingredient name\"||ingredients[i].name===\"\"||ingredients[i].quantity===\"Enter quantity\"||ingredients[i].quantity===\"\"){err.push(\"Please ensure all the ingredient names and quantity are listed properly\");break;}}if(err.length>0){_this.setState({errorMessages:err});return;}var formdata=new FormData();formdata.append(\"steps\",JSON.stringify(steps));formdata.append(\"ingredients\",JSON.stringify(ingredients));formdata.append(\"title\",title);formdata.append(\"image\",image,image.name);var requestOptions={method:\"POST\",body:formdata,redirect:\"follow\"};fetch(\"https://my-vegan-recipes.herokuapp.com/api/v1/recipes\",requestOptions).then(function(response){return response.text();}).then(function(result){var res=JSON.parse(result);if(res.status===\"error\"){var err=[];err.push(res.message);_this.setState({errorMessages:err});}else if(res.status===\"success\"){var id=res.data.data._id;_this.setState({infoUploaded:true,id:id});}}).catch(function(error){console.log(error);});};_this.state={title:\"Enter title\",steps:[{instruction:\"Enter instruction\"}],ingredients:[{name:\"Enter ingredient name\",quantity:\"Enter quantity\"}],image:null,errorMessages:[],infoUploaded:false};return _this;}_createClass(Recipe,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"title\",children:\"Create a new Vegan Recipe!\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"form\",{className:\"form-wrap\",onSubmit:this.handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-label label\",children:\"Title:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:this.state.title,name:\"title\",onChange:this.handleChange,className:\"title-input input\"}),/*#__PURE__*/_jsx(\"div\",{className:\"img-label label\",children:\"Upload an image of the item:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:this.selectImages,accept:\".jpg, .jpeg, .png, .pdf\",className:\"img-upload\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Ingredients required:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ingredient-wrap\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label ingredient-label\",children:\"Ingredient:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"label quantity-label\",children:\"quantity:\"})]}),this.state.ingredients.map(function(ingredient,i){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:ingredient.name,name:\"name\",id:i,onChange:_this2.handleIngredient,className:\"input ingredient-input\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:ingredient.quantity,name:\"quantity\",id:i,onChange:_this2.handleIngredient,className:\"input quantity-input\"}),/*#__PURE__*/_jsx(\"button\",{className:\"x\",id:i,onClick:_this2.handleIngredientDelete,children:\"x\"})]},i);}),/*#__PURE__*/_jsx(\"button\",{className:\"add\",name:\"addIngredient\",onClick:this.handleIngredientAdd,children:\"+ Add Ingredient\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Instructions:\"}),this.state.steps.map(function(step,i){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"label step-label\",children:[\"step \",i+1,\":\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:step.instruction,name:\"instruction\",id:i,onChange:_this2.handleStep,className:\"input step-input\"}),/*#__PURE__*/_jsx(\"button\",{className:\"x\",id:i,onClick:_this2.handleStepDelete,children:\"x\"})]},i);}),/*#__PURE__*/_jsx(\"button\",{className:\"add\",name:\"addStep\",onClick:this.handleStepAdd,children:\"+ Add Instruction\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"button submit\",onClick:this.handleSubmit,children:\"submit\"}),/*#__PURE__*/_jsx(\"div\",{className:\"err-wrap\",children:this.state.errorMessages&&this.state.errorMessages.map(function(err,i){return/*#__PURE__*/_jsx(\"div\",{children:err},i);})})]})}),this.state.infoUploaded&&/*#__PURE__*/_jsxs(\"div\",{className:\"background\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"question\",children:\"Your recipe has been successfully uploaded!\"}),/*#__PURE__*/_jsx(Link,{className:\"buttons-wrap\",to:\"/\".concat(this.state.id),children:/*#__PURE__*/_jsx(\"button\",{className:\"button link\",children:\"View Recipe\"})})]})]});}}]);return Recipe;}(Component);export default Recipe;","map":{"version":3,"sources":["C:/NTU/Admin/internship/recipe app - abillionveg/client/src/components/Create.js"],"names":["React","Component","Link","Recipe","selectImages","event","image","target","files","setState","handleStepAdd","preventDefault","values","state","steps","push","instruction","handleStepDelete","id","splice","handleStep","name","value","handleIngredientAdd","ingredients","quantity","handleIngredientDelete","handleIngredient","handleChange","handleSubmit","createRecipe","err","title","type","j","length","i","errorMessages","formdata","FormData","append","JSON","stringify","requestOptions","method","body","redirect","fetch","then","response","text","result","res","parse","status","message","data","_id","infoUploaded","catch","error","console","log","map","ingredient","step"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nclass Recipe extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      title: \"Enter title\",\r\n      steps: [{ instruction: \"Enter instruction\" }],\r\n      ingredients: [\r\n        { name: \"Enter ingredient name\", quantity: \"Enter quantity\" },\r\n      ],\r\n      image: null,\r\n      errorMessages: [],\r\n      infoUploaded: false,\r\n    };\r\n  }\r\n\r\n  selectImages = (event) => {\r\n    let image = event.target.files[0];\r\n    this.setState({ image });\r\n  };\r\n  handleStepAdd = (event) => {\r\n    event.preventDefault();\r\n    var values = [...this.state.steps];\r\n    values.push({ instruction: \"Enter instruction\" });\r\n    this.setState({ steps: values });\r\n  };\r\n  handleStepDelete = (event) => {\r\n    event.preventDefault();\r\n    const { id } = event.target;\r\n    var values = [...this.state.steps];\r\n    values.splice(id, 1);\r\n    this.setState({ steps: values });\r\n  };\r\n  handleStep = (event) => {\r\n    const { id, name, value } = event.target;\r\n    var values = [...this.state.steps];\r\n    values[id][name] = value;\r\n    this.setState({ steps: values });\r\n  };\r\n  handleIngredientAdd = (event) => {\r\n    event.preventDefault();\r\n    var values = [...this.state.ingredients];\r\n    values.push({ name: \"Enter ingredient name\", quantity: \"Enter quantity\" });\r\n    this.setState({ ingredients: values });\r\n  };\r\n  handleIngredientDelete = (event) => {\r\n    event.preventDefault();\r\n    const { id } = event.target;\r\n    var values = [...this.state.ingredients];\r\n    values.splice(id, 1);\r\n    this.setState({ ingredients: values });\r\n  };\r\n  handleIngredient = (event) => {\r\n    const { id, name, value } = event.target;\r\n    var values = [...this.state.ingredients];\r\n    values[id][name] = value;\r\n    this.setState({ ingredients: values });\r\n  };\r\n\r\n  handleChange = (event) => {\r\n    const { name, value } = event.target;\r\n    this.setState({ [name]: value });\r\n  };\r\n  handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    this.createRecipe();\r\n  };\r\n\r\n  createRecipe = () => {\r\n    var err = [];\r\n    const { steps, image, title, ingredients } = this.state;\r\n\r\n    if (image === null || title === \"Enter title\" || title === \"\") {\r\n      err.push(\"Please enter all the information\");\r\n    } else if (\r\n      !(\r\n        image.type === \"image/jpeg\" ||\r\n        image.type === \"image/jpg\" ||\r\n        image.type === \"image/png\" ||\r\n        image.type === \"image/pdf\"\r\n      )\r\n    ) {\r\n      err.push(\"Only images of type jpeg, jpg, png or pdf can be uploaded\");\r\n    }\r\n    for (var j = 0; j < steps.length; j++) {\r\n      if (\r\n        steps[j].instruction === \"Enter instruction\" ||\r\n        steps[j].instruction === \"\"\r\n      ) {\r\n        err.push(\"Please ensure all the instructions are listed properly\");\r\n        break;\r\n      }\r\n    }\r\n    for (var i = 0; i < ingredients.length; i++) {\r\n      if (\r\n        ingredients[i].name === \"Enter ingredient name\" ||\r\n        ingredients[i].name === \"\" ||\r\n        ingredients[i].quantity === \"Enter quantity\" ||\r\n        ingredients[i].quantity === \"\"\r\n      ) {\r\n        err.push(\r\n          \"Please ensure all the ingredient names and quantity are listed properly\"\r\n        );\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (err.length > 0) {\r\n      this.setState({ errorMessages: err });\r\n      return;\r\n    }\r\n\r\n    var formdata = new FormData();\r\n\r\n    formdata.append(\"steps\", JSON.stringify(steps));\r\n    formdata.append(\"ingredients\", JSON.stringify(ingredients));\r\n    formdata.append(\"title\", title);\r\n    formdata.append(\"image\", image, image.name);\r\n\r\n    var requestOptions = {\r\n      method: \"POST\",\r\n      body: formdata,\r\n      redirect: \"follow\",\r\n    };\r\n\r\n    fetch(\r\n      \"https://my-vegan-recipes.herokuapp.com/api/v1/recipes\",\r\n      requestOptions\r\n    )\r\n      .then((response) => response.text())\r\n      .then((result) => {\r\n        const res = JSON.parse(result);\r\n\r\n        if (res.status === \"error\") {\r\n          var err = [];\r\n          err.push(res.message);\r\n          this.setState({ errorMessages: err });\r\n        } else if (res.status === \"success\") {\r\n          const id = res.data.data._id;\r\n          this.setState({\r\n            infoUploaded: true,\r\n            id,\r\n          });\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n  render() {\r\n    return (\r\n      <div>\r\n        <h1 className=\"title\">Create a new Vegan Recipe!</h1>\r\n        <div>\r\n          <form className=\"form-wrap\" onSubmit={this.handleSubmit}>\r\n            <div className=\"title-label label\">Title:</div>\r\n            <input\r\n              type=\"text\"\r\n              value={this.state.title}\r\n              name=\"title\"\r\n              onChange={this.handleChange}\r\n              className=\"title-input input\"\r\n            />\r\n            <div className=\"img-label label\">Upload an image of the item:</div>\r\n            <input\r\n              type=\"file\"\r\n              onChange={this.selectImages}\r\n              accept=\".jpg, .jpeg, .png, .pdf\"\r\n              className=\"img-upload\"\r\n            />\r\n            <div>\r\n              <div className=\"label\">Ingredients required:</div>\r\n              <div className=\"ingredient-wrap\">\r\n                <span className=\"label ingredient-label\">Ingredient:</span>\r\n                <span className=\"label quantity-label\">quantity:</span>\r\n              </div>\r\n              {this.state.ingredients.map((ingredient, i) => (\r\n                <div key={i}>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={ingredient.name}\r\n                    name=\"name\"\r\n                    id={i}\r\n                    onChange={this.handleIngredient}\r\n                    className=\"input ingredient-input\"\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    value={ingredient.quantity}\r\n                    name=\"quantity\"\r\n                    id={i}\r\n                    onChange={this.handleIngredient}\r\n                    className=\"input quantity-input\"\r\n                  />\r\n                  <button\r\n                    className=\"x\"\r\n                    id={i}\r\n                    onClick={this.handleIngredientDelete}\r\n                  >\r\n                    x\r\n                  </button>\r\n                </div>\r\n              ))}\r\n              <button\r\n                className=\"add\"\r\n                name=\"addIngredient\"\r\n                onClick={this.handleIngredientAdd}\r\n              >\r\n                + Add Ingredient\r\n              </button>\r\n            </div>\r\n\r\n            <div>\r\n              <div className=\"label\">Instructions:</div>\r\n              {this.state.steps.map((step, i) => (\r\n                <div key={i}>\r\n                  <span className=\"label step-label\">step {i + 1}:</span>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={step.instruction}\r\n                    name=\"instruction\"\r\n                    id={i}\r\n                    onChange={this.handleStep}\r\n                    className=\"input step-input\"\r\n                  />\r\n\r\n                  <button className=\"x\" id={i} onClick={this.handleStepDelete}>\r\n                    x\r\n                  </button>\r\n                </div>\r\n              ))}\r\n              <button\r\n                className=\"add\"\r\n                name=\"addStep\"\r\n                onClick={this.handleStepAdd}\r\n              >\r\n                + Add Instruction\r\n              </button>\r\n            </div>\r\n            <button className=\"button submit\" onClick={this.handleSubmit}>\r\n              submit\r\n            </button>\r\n            <div className=\"err-wrap\">\r\n              {this.state.errorMessages &&\r\n                this.state.errorMessages.map((err, i) => (\r\n                  <div key={i}>{err}</div>\r\n                ))}\r\n            </div>\r\n          </form>\r\n        </div>\r\n        {this.state.infoUploaded && (\r\n          <div className=\"background\">\r\n            <h1 className=\"question\">\r\n              Your recipe has been successfully uploaded!\r\n            </h1>\r\n            <Link className=\"buttons-wrap\" to={`/${this.state.id}`}>\r\n              <button className=\"button link\">View Recipe</button>\r\n            </Link>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Recipe;\r\n"]},"metadata":{},"sourceType":"module"}