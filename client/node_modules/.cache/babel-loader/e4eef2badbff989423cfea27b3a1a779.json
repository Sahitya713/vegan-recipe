{"ast":null,"code":"import _defineProperty from\"C:/NTU/Admin/internship/recipe app - abillionveg/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"C:/NTU/Admin/internship/recipe app - abillionveg/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"C:/NTU/Admin/internship/recipe app - abillionveg/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/NTU/Admin/internship/recipe app - abillionveg/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/NTU/Admin/internship/recipe app - abillionveg/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/NTU/Admin/internship/recipe app - abillionveg/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Edit=/*#__PURE__*/function(_Component){_inherits(Edit,_Component);var _super=_createSuper(Edit);function Edit(){var _this;_classCallCheck(this,Edit);_this=_super.call(this);_this.getID=function(){var id=_this.props.match.params.id;_this.setState({id:id},_this.getRecipe);};_this.getRecipe=function(){var requestOptions={method:\"GET\",redirect:\"follow\"};fetch(\"https://my-vegan-recipes.herokuapp.com/api/v1/recipes/\".concat(_this.state.id),requestOptions).then(function(res){return res.text();}).then(function(res){var response=JSON.parse(res).data.data;var data={};data.title=response.title;data.imageUrl=response.image;data.ingredients=response.ingredients;data.steps=response.steps;// const responses = JSON.parse(res).data.data;\n_this.setState(data);}).catch(function(error){return console.log(\"error\",error);});};_this.componentWillMount=function(){_this.getID();};_this.selectImages=function(event){var image=event.target.files[0];_this.setState({image:image});};_this.handleStepAdd=function(event){event.preventDefault();var values=_toConsumableArray(_this.state.steps);values.push({instruction:\"Enter instruction\"});_this.setState({steps:values});};_this.handleStepDelete=function(event){event.preventDefault();var id=event.target.id;var values=_toConsumableArray(_this.state.steps);values.splice(id,1);_this.setState({steps:values});};_this.handleStep=function(event){var _event$target=event.target,id=_event$target.id,name=_event$target.name,value=_event$target.value;var values=_toConsumableArray(_this.state.steps);values[id][name]=value;_this.setState({steps:values});};_this.handleIngredientAdd=function(event){event.preventDefault();var values=_toConsumableArray(_this.state.ingredients);values.push({name:\"Enter ingredient name\",quantity:\"Enter quantity\"});_this.setState({ingredients:values});};_this.handleIngredientDelete=function(event){event.preventDefault();var id=event.target.id;var values=_toConsumableArray(_this.state.ingredients);values.splice(id,1);_this.setState({ingredients:values});};_this.handleIngredient=function(event){var _event$target2=event.target,id=_event$target2.id,name=_event$target2.name,value=_event$target2.value;var values=_toConsumableArray(_this.state.ingredients);values[id][name]=value;_this.setState({ingredients:values});};_this.handleChange=function(event){var _event$target3=event.target,name=_event$target3.name,value=_event$target3.value;_this.setState(_defineProperty({},name,value));};_this.handleSubmit=function(event){event.preventDefault();_this.updateRecipe();};_this.updateRecipe=function(){var err=[];var _this$state=_this.state,steps=_this$state.steps,image=_this$state.image,title=_this$state.title,ingredients=_this$state.ingredients;if(title===\"\")err.push(\"Please enter a title\");if(image&&!(image.type===\"image/jpeg\"||image.type===\"image/jpg\"||image.type===\"image/png\"||image.type===\"image/pdf\")){err.push(\"Only images of type jpeg, jpg, png or pdf can be uploaded\");}for(var j=0;j<steps.length;j++){if(steps[j].instruction===\"Enter instruction\"||steps[j].instruction===\"\"){err.push(\"Please ensure all the instructions are listed properly\");break;}}for(var i=0;i<ingredients.length;i++){if(ingredients[i].name===\"Enter ingredient name\"||ingredients[i].name===\"\"||ingredients[i].quantity===\"Enter quantity\"||ingredients[i].quantity===\"\"){err.push(\"Please ensure all the ingredient names and quantity are listed properly\");break;}}if(err.length>0){_this.setState({errorMessages:err});return;}var formdata=new FormData();formdata.append(\"steps\",JSON.stringify(steps));formdata.append(\"ingredients\",JSON.stringify(ingredients));formdata.append(\"title\",title);if(image){formdata.append(\"image\",image,image.name);}var requestOptions={method:\"PATCH\",body:formdata,redirect:\"follow\"};fetch(\"https://my-vegan-recipes.herokuapp.com/api/v1/recipes/\".concat(_this.state.id),requestOptions).then(function(response){return response.text();}).then(function(result){var res=JSON.parse(result);if(res.status===\"error\"){var err=[];err.push(res.message);_this.setState({errorMessages:err});}else if(res.status===\"success\"){_this.setState({infoUpdated:true});}}).catch(function(error){console.log(error);});};_this.state={title:\"Enter title\",steps:[{instruction:\"Enter instruction\"}],ingredients:[{name:\"Enter ingredient name\",quantity:\"Enter quantity\"}],imageUrl:\"\",image:null,errorMessages:[],infoUpdated:false};return _this;}_createClass(Edit,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"title\",children:\"Edit your Recipe!\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"form\",{className:\"form-wrap\",onSubmit:this.updateRecipe,children:[/*#__PURE__*/_jsx(\"div\",{className:\"title-label label\",children:\"Title:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:this.state.title,name:\"title\",onChange:this.handleChange,className:\"title-input input\"}),/*#__PURE__*/_jsx(\"div\",{className:\"curr-img-wrap\",children:/*#__PURE__*/_jsx(\"img\",{className:\"curr-img\",src:this.state.imageUrl,alt:\"OriginalImage\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"img-label label\",children:\"Upload a different image\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:this.selectImages,accept:\".jpg, .jpeg, .png, .pdf\",className:\"img-upload\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Ingredients required:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ingredient-wrap\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label ingredient-label\",children:\"Ingredient:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"label quantity-label\",children:\"quantity:\"})]}),this.state.ingredients.map(function(ingredient,i){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:ingredient.name,name:\"name\",id:i,onChange:_this2.handleIngredient,className:\"input ingredient-input\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:ingredient.quantity,name:\"quantity\",id:i,onChange:_this2.handleIngredient,className:\"input quantity-input\"}),/*#__PURE__*/_jsx(\"button\",{className:\"x\",id:i,onClick:_this2.handleIngredientDelete,children:\"x\"})]},i);}),/*#__PURE__*/_jsx(\"button\",{className:\"add\",name:\"addIngredient\",onClick:this.handleIngredientAdd,children:\"+ Add Ingredient\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Instructions:\"}),this.state.steps.map(function(step,i){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"label step-label\",children:[\"step \",i+1,\":\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:step.instruction,name:\"instruction\",id:i,onChange:_this2.handleStep,className:\"input step-input\"}),/*#__PURE__*/_jsx(\"button\",{className:\"x\",id:i,onClick:_this2.handleStepDelete,children:\"x\"})]},i);}),/*#__PURE__*/_jsx(\"button\",{className:\"add\",name:\"addStep\",onClick:this.handleStepAdd,children:\"+ Add Instruction\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"button submit\",onClick:this.handleSubmit,children:\"Edit\"}),/*#__PURE__*/_jsx(\"div\",{className:\"err-wrap\",children:this.state.errorMessages.map(function(err,i){return/*#__PURE__*/_jsx(\"div\",{children:err},i);})})]})}),this.state.infoUpdated&&/*#__PURE__*/_jsxs(\"div\",{className:\"background\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"question\",children:\"Your recipe has been successfully updated!\"}),/*#__PURE__*/_jsx(Link,{className:\"buttons-wrap \",to:\"/\".concat(this.state.id),children:/*#__PURE__*/_jsx(\"button\",{className:\"button link\",children:\"View Recipe\"})})]})]});}}]);return Edit;}(Component);export default Edit;","map":{"version":3,"sources":["C:/NTU/Admin/internship/recipe app - abillionveg/client/src/components/Edit.js"],"names":["React","Component","Link","Edit","getID","id","props","match","params","setState","getRecipe","requestOptions","method","redirect","fetch","state","then","res","text","response","JSON","parse","data","title","imageUrl","image","ingredients","steps","catch","error","console","log","componentWillMount","selectImages","event","target","files","handleStepAdd","preventDefault","values","push","instruction","handleStepDelete","splice","handleStep","name","value","handleIngredientAdd","quantity","handleIngredientDelete","handleIngredient","handleChange","handleSubmit","updateRecipe","err","type","j","length","i","errorMessages","formdata","FormData","append","stringify","body","result","status","message","infoUpdated","map","ingredient","step"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nclass Edit extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      title: \"Enter title\",\r\n      steps: [{ instruction: \"Enter instruction\" }],\r\n      ingredients: [\r\n        { name: \"Enter ingredient name\", quantity: \"Enter quantity\" },\r\n      ],\r\n      imageUrl: \"\",\r\n      image: null,\r\n      errorMessages: [],\r\n      infoUpdated: false,\r\n    };\r\n  }\r\n\r\n  getID = () => {\r\n    const id = this.props.match.params.id;\r\n    this.setState({ id }, this.getRecipe);\r\n  };\r\n\r\n  getRecipe = () => {\r\n    var requestOptions = {\r\n      method: \"GET\",\r\n      redirect: \"follow\",\r\n    };\r\n\r\n    fetch(\r\n      `https://my-vegan-recipes.herokuapp.com/api/v1/recipes/${this.state.id}`,\r\n      requestOptions\r\n    )\r\n      .then((res) => res.text())\r\n      .then((res) => {\r\n        const response = JSON.parse(res).data.data;\r\n\r\n        let data = {};\r\n        data.title = response.title;\r\n        data.imageUrl = response.image;\r\n        data.ingredients = response.ingredients;\r\n        data.steps = response.steps;\r\n\r\n        // const responses = JSON.parse(res).data.data;\r\n        this.setState(data);\r\n      })\r\n      .catch((error) => console.log(\"error\", error));\r\n  };\r\n  componentWillMount = () => {\r\n    this.getID();\r\n  };\r\n\r\n  selectImages = (event) => {\r\n    let image = event.target.files[0];\r\n    this.setState({ image });\r\n  };\r\n  handleStepAdd = (event) => {\r\n    event.preventDefault();\r\n    var values = [...this.state.steps];\r\n    values.push({ instruction: \"Enter instruction\" });\r\n    this.setState({ steps: values });\r\n  };\r\n  handleStepDelete = (event) => {\r\n    event.preventDefault();\r\n    const { id } = event.target;\r\n    var values = [...this.state.steps];\r\n    values.splice(id, 1);\r\n    this.setState({ steps: values });\r\n  };\r\n  handleStep = (event) => {\r\n    const { id, name, value } = event.target;\r\n    var values = [...this.state.steps];\r\n    values[id][name] = value;\r\n    this.setState({ steps: values });\r\n  };\r\n  handleIngredientAdd = (event) => {\r\n    event.preventDefault();\r\n    var values = [...this.state.ingredients];\r\n    values.push({ name: \"Enter ingredient name\", quantity: \"Enter quantity\" });\r\n    this.setState({ ingredients: values });\r\n  };\r\n  handleIngredientDelete = (event) => {\r\n    event.preventDefault();\r\n    const { id } = event.target;\r\n    var values = [...this.state.ingredients];\r\n    values.splice(id, 1);\r\n    this.setState({ ingredients: values });\r\n  };\r\n  handleIngredient = (event) => {\r\n    const { id, name, value } = event.target;\r\n    var values = [...this.state.ingredients];\r\n    values[id][name] = value;\r\n    this.setState({ ingredients: values });\r\n  };\r\n\r\n  handleChange = (event) => {\r\n    const { name, value } = event.target;\r\n    this.setState({ [name]: value });\r\n  };\r\n  handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    this.updateRecipe();\r\n  };\r\n\r\n  updateRecipe = () => {\r\n    var err = [];\r\n    const { steps, image, title, ingredients } = this.state;\r\n\r\n    if (title === \"\") err.push(\"Please enter a title\");\r\n    if (\r\n      image &&\r\n      !(\r\n        image.type === \"image/jpeg\" ||\r\n        image.type === \"image/jpg\" ||\r\n        image.type === \"image/png\" ||\r\n        image.type === \"image/pdf\"\r\n      )\r\n    ) {\r\n      err.push(\"Only images of type jpeg, jpg, png or pdf can be uploaded\");\r\n    }\r\n    for (var j = 0; j < steps.length; j++) {\r\n      if (\r\n        steps[j].instruction === \"Enter instruction\" ||\r\n        steps[j].instruction === \"\"\r\n      ) {\r\n        err.push(\"Please ensure all the instructions are listed properly\");\r\n        break;\r\n      }\r\n    }\r\n    for (var i = 0; i < ingredients.length; i++) {\r\n      if (\r\n        ingredients[i].name === \"Enter ingredient name\" ||\r\n        ingredients[i].name === \"\" ||\r\n        ingredients[i].quantity === \"Enter quantity\" ||\r\n        ingredients[i].quantity === \"\"\r\n      ) {\r\n        err.push(\r\n          \"Please ensure all the ingredient names and quantity are listed properly\"\r\n        );\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (err.length > 0) {\r\n      this.setState({ errorMessages: err });\r\n      return;\r\n    }\r\n\r\n    var formdata = new FormData();\r\n\r\n    formdata.append(\"steps\", JSON.stringify(steps));\r\n    formdata.append(\"ingredients\", JSON.stringify(ingredients));\r\n    formdata.append(\"title\", title);\r\n    if (image) {\r\n      formdata.append(\"image\", image, image.name);\r\n    }\r\n\r\n    var requestOptions = {\r\n      method: \"PATCH\",\r\n      body: formdata,\r\n      redirect: \"follow\",\r\n    };\r\n\r\n    fetch(\r\n      `https://my-vegan-recipes.herokuapp.com/api/v1/recipes/${this.state.id}`,\r\n      requestOptions\r\n    )\r\n      .then((response) => response.text())\r\n\r\n      .then((result) => {\r\n        const res = JSON.parse(result);\r\n\r\n        if (res.status === \"error\") {\r\n          var err = [];\r\n          err.push(res.message);\r\n          this.setState({ errorMessages: err });\r\n        } else if (res.status === \"success\") {\r\n          this.setState({\r\n            infoUpdated: true,\r\n          });\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n  render() {\r\n    return (\r\n      <div>\r\n        <h1 className=\"title\">Edit your Recipe!</h1>\r\n        <div>\r\n          <form className=\"form-wrap\" onSubmit={this.updateRecipe}>\r\n            <div className=\"title-label label\">Title:</div>\r\n            <input\r\n              type=\"text\"\r\n              value={this.state.title}\r\n              name=\"title\"\r\n              onChange={this.handleChange}\r\n              className=\"title-input input\"\r\n            />\r\n            <div className=\"curr-img-wrap\">\r\n              <img\r\n                className=\"curr-img\"\r\n                src={this.state.imageUrl}\r\n                alt=\"OriginalImage\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"img-label label\">Upload a different image</div>\r\n            <input\r\n              type=\"file\"\r\n              onChange={this.selectImages}\r\n              accept=\".jpg, .jpeg, .png, .pdf\"\r\n              className=\"img-upload\"\r\n            />\r\n            <div>\r\n              <div className=\"label\">Ingredients required:</div>\r\n              <div className=\"ingredient-wrap\">\r\n                <span className=\"label ingredient-label\">Ingredient:</span>\r\n                <span className=\"label quantity-label\">quantity:</span>\r\n              </div>\r\n              {this.state.ingredients.map((ingredient, i) => (\r\n                <div key={i}>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={ingredient.name}\r\n                    name=\"name\"\r\n                    id={i}\r\n                    onChange={this.handleIngredient}\r\n                    className=\"input ingredient-input\"\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    value={ingredient.quantity}\r\n                    name=\"quantity\"\r\n                    id={i}\r\n                    onChange={this.handleIngredient}\r\n                    className=\"input quantity-input\"\r\n                  />\r\n                  <button\r\n                    className=\"x\"\r\n                    id={i}\r\n                    onClick={this.handleIngredientDelete}\r\n                  >\r\n                    x\r\n                  </button>\r\n                </div>\r\n              ))}\r\n              <button\r\n                className=\"add\"\r\n                name=\"addIngredient\"\r\n                onClick={this.handleIngredientAdd}\r\n              >\r\n                + Add Ingredient\r\n              </button>\r\n            </div>\r\n\r\n            <div>\r\n              <div className=\"label\">Instructions:</div>\r\n              {this.state.steps.map((step, i) => (\r\n                <div key={i}>\r\n                  <span className=\"label step-label\">step {i + 1}:</span>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={step.instruction}\r\n                    name=\"instruction\"\r\n                    id={i}\r\n                    onChange={this.handleStep}\r\n                    className=\"input step-input\"\r\n                  />\r\n\r\n                  <button className=\"x\" id={i} onClick={this.handleStepDelete}>\r\n                    x\r\n                  </button>\r\n                </div>\r\n              ))}\r\n              <button\r\n                className=\"add\"\r\n                name=\"addStep\"\r\n                onClick={this.handleStepAdd}\r\n              >\r\n                + Add Instruction\r\n              </button>\r\n            </div>\r\n            <button className=\"button submit\" onClick={this.handleSubmit}>\r\n              Edit\r\n            </button>\r\n            <div className=\"err-wrap\">\r\n              {this.state.errorMessages.map((err, i) => (\r\n                <div key={i}>{err}</div>\r\n              ))}\r\n            </div>\r\n          </form>\r\n        </div>\r\n        {this.state.infoUpdated && (\r\n          <div className=\"background\">\r\n            <h1 className=\"question\">\r\n              Your recipe has been successfully updated!\r\n            </h1>\r\n            <Link className=\"buttons-wrap \" to={`/${this.state.id}`}>\r\n              <button className=\"button link\">View Recipe</button>\r\n            </Link>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default Edit;\r\n"]},"metadata":{},"sourceType":"module"}